[tox]
envlist = py{39,310,311,312}
skipsdist = true

[testenv]
description = Run lint and tests for {envname}
deps =
    pytest
    ruff
commands_pre =
    python -m pip install -U pip
    python -m pip install -e .
commands =
    ruff check src || python -c "print('no src directory to lint')"
    pytest -q || python - <<'PY'
    try:
        import importlib
        # Attempt to import inc_join top-level module
        importlib.import_module('inc_join')
        print('Import ok')
    except Exception as e:
        raise SystemExit(f'Import failed: {e}')
    PY
